var PAGE_DASHBOARD=function(){function e(){t(),n()}function n(){$("#pageDashboard").find("#relayQueueMonitor").find(".ajax").show(),$(".queueTotal").html('<i class="fa fa-spinner fa-pulse"></i>'),$("#relayQueueMonitorContent").html(""),$.when(RELAY.serviceQueueXHR()).done(function(e){var n=e.total||"Ingen jobber i k&oslash;",t=e.jobs?JSON.stringify(e.jobs,null,4):"Ingen detaljer tilgjengelig";$("#relayQueueMonitorContent").html("<strong>Jobber:</strong> "+n+"<br><strong>Detaljer:</strong> "+t),$("#pageDashboard").find("#relayQueueMonitor").find(".ajax").hide(),$("#pageDashboard").find("#queueBox").find(".ajax").hide(),$(".queueTotal").html(e.total||0)})}function t(){$("#subscriber_table_body").empty();var e,n="---",t="red";$.each(KIND.subscribers(),function(o,r){e="",n=KIND.subscriptionCodesToNames()[r.subscription_code],t=KIND.subscriptionCodesToColors()[r.subscription_code],r.org_id==DATAPORTEN.user().org.id&&(e="active"),$("#subscriber_table_body").append("<tr class='"+e+"'><td>"+r.org_id+"</td><td style='text-align: center;'><span class='label bg-"+t+"'>"+n+"</span></td></tr>")}),$("#pageDashboard").find("#subscribersTable").find(".ajax").hide()}function o(e){i();var n=[];$.each(e,function(e,t){n.push({value:t.users,color:"#"+(Math.random().toString(16)+"0000000").slice(2,8),highlight:"#"+(Math.random().toString(16)+"0000000").slice(2,8),label:""})});var t=document.getElementById("chartOrgsUserCountDashboard").getContext("2d");return new Chart(t).Pie(n,{})}function r(){$.when(RELAY.ready()).done(function(){s=o(RELAY.subscribersInfo()),$("#pageDashboard").find("#usersPie").find(".ajax").hide()})}function a(){i()}function i(){s!==!1&&(s.destroy(),s=!1,$("#pageDashboard").find("#usersPie").find(".ajax").show())}var s=!1;return $(".updateQueue").on("click",function(){n()}),{init:function(){return e()},hide:function(){a()},show:function(){r()},refreshQueue:function(){n()}}}();