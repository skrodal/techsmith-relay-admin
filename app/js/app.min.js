var APP=function(){function t(){$("span.supportEmail").html(CONFIG.RELAY_SUPPORT_EMAIL()),$("span.relaySupportURL").html(CONFIG.RELAY_SUPPORT_URL()),$("a.relaySupportURL").attr("href",CONFIG.RELAY_SUPPORT_URL()),$("span.relayServiceURL").html(CONFIG.RELAY_SERVICE_URL()),$("a.relayServiceURL").attr("href",CONFIG.RELAY_SERVICE_URL()),$("span.screencastBaseURL").html(CONFIG.SCREENCAST_BASE_URL()),$("a.screencastBaseURL").attr("href",CONFIG.SCREENCAST_BASE_URL()),$("a.relayRegisterURL").attr("href",CONFIG.RELAY_REGISTER_URL()),$("a.relayClientDownloadURL").attr("href",CONFIG.RELAY_CLIENT_DOWNLOAD_URL())}function e(){$(".userFirstName").html(" "+DATAPORTEN.user().name.first),$(".userFullName").html(" "+DATAPORTEN.user().name.full),$(".feideOrg").html(" "+DATAPORTEN.user().org.name),$(".feideAffiliation").html(" Ansatt"),$(".userImage").attr("src",DATAPORTEN.user().photo),$("#dataportenSessionInfo").text(JSON.stringify(DATAPORTEN.user(),void 0,2)),$("#userMenu").fadeIn().removeClass("hidden")}function n(){$(".userRole").html(" "+DATAPORTEN.userRole()),$(".subscribersCount").html(KIND.subscriptionCount().full),$(".subscribersTrialCount").html(KIND.subscriptionCount().trial),$(".subscribersOtherCount").html(KIND.subscriptionCount().other),$(".subscribersTotalCount").html(KIND.subscriptionCount().total);var t,e,n,r=!1;KIND.subscriberDetails().contact_support?(e=KIND.subscriberDetails().contact_support.navn||null,n=KIND.subscriberDetails().contact_support.direkte_telefon||"mangler",r=KIND.subscriberDetails().contact_support.mobil_telefon||"mangler",t=KIND.subscriberDetails().contact_support.e_post||!1,t!==!1&&(t=t.indexOf("@")>0?'<a href="mailto:'+t+'" class="text-navy">Send epost</a>':'<a href="'+t+'" target="_blank" class="text-blue">G&aring; til nettsted</a> '),$("#supportDetails").html('<h4>Ditt supportpunkt: </h4><p class="bold">'+e+"</p><p>"+t+"</p><p>Tlf: "+n+"</p><p>Mobil: "+r+"</p>")):$("#supportDetails").html("<h4>Ditt supportpunkt</h4><p>Vi har dessverre ikke registrert noe kontaktpunkt for ditt lærested. Dersom du trenger bistand, forsøk IT-helpdesk for din avdeling.</p>")}function r(){$(".storageCostPerTB").html(RELAY.storageCostTB()),$.when(RELAY.usersTotalXHR()).done(function(t){$(".globalUsersCountTotal").html(t.employees+t.students),$(".globalUsersCountByAffiliation").html(t.employees+" ansatte og "+t.students+" studenter")}),$.when(RELAY.usersTotalActiveXHR()).done(function(t){$(".globalActiveUsersCountTotal").html(t.employees+t.students),$(".globalActiveUsersCountByAffiliation").html(t.employees+" ansatte og "+t.students+" studenter")}),$.when(RELAY.presentationsTotalXHR()).done(function(t){$(".globalPresentationCount").html(t)}),$.when(RELAY.serviceStorageXHR()).done(function(t){$(".subscribersDiskusageTotal").html(UTILS.mib2tb(t).toFixed(2)+"TB")}),$.when(RELAY.ready()).done(function(){$(".homeOrgUserCount").html(RELAY.orgUserCount(DATAPORTEN.user().org.id))}),$.when(RELAY.serviceVersionXHR()).done(function(t){$(".relayVersion").html(t)}),$.when(RELAY.serviceWorkersXHR()).done(function(t){$(".relayWorkers").html(t)}),$("#pageDashboard").find("#serverInfo").find(".ajax").hide()}function s(){}var o;return $(document).ready(function(){o=new JSONEditor(document.getElementById("jsonDataExport"),{modes:["view","text"],mode:"text",search:!0,indentation:4}),t(),$.when(DATAPORTEN.readyUser()).done(function(){$.when(DATAPORTEN.readyGroups()).done(function(){$.when(DATAPORTEN.readyUserRole()).done(function(){e(),$.when(KIND.ready()).done(function(){n(),$.when(RELAY_USER.accountXHR()).done(function(){if(s(),DATAPORTEN.isOrgAdmin()||DATAPORTEN.isSuperAdmin())RELAY.init(),$.when(RELAY.ready()).done(function(){MENU.init(),r()});else{if(!RELAY_USER.hasAccount())return UTILS.showAuthError("Manglende tilgang","Du mangler brukerkonto og er ikke administrator for tjenesten. Tilgang er derfor sperret."),!1;MENU.init()}})})})})})}),$(document).on("mouseenter",".mightOverflow",function(){var t=$(this),e=t.attr("title");e?this.offsetWidth>=this.scrollWidth&&e==t.text()&&t.removeAttr("title"):this.offsetWidth<this.scrollWidth&&t.attr("title",t.text())}),{jsonEditor:function(){return o}}}();