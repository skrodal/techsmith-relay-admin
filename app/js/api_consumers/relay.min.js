var RELAY=function(){function e(){p=a(),m=n(),v=i(),T=c(),y=o(),$.when(p).done(function(e){g=e;var n=$.notify({icon:DATAPORTEN.user().photo,title:"Hey "+DATAPORTEN.user().name.first+", du er admin!",message:"Henter ekstra innhold for deg :-)"},{type:"minimalist",delay:1e5,icon_type:"image",template:'<div data-notify="container" class="col-xs-11 col-sm-3 alert alert-{0}" role="alert"><img data-notify="icon" class="img-circle pull-left"><span data-notify="title">{1}</span><span data-notify="message">{2}</span></div>'});A.resolve(),n.update({message:"Ferdig! Menyen er oppdatert."}),setTimeout(function(){n.close()},1e3)})}function n(){return d("service/info/")}function t(){return d("service/queue/")}function r(){return d("service/queue/failed/")}function o(){return d("service/diskusage/")}function i(){return d("service/users/count/")}function u(e){if(DATAPORTEN.isSuperAdmin())return d("org/"+e+"/presentations/")}function s(e){if(DATAPORTEN.isSuperAdmin())return d("org/"+e+"/users/")}function a(){return d("admin/orgs/info/")}function c(){return d("service/presentations/count/")}function f(e){return d("service/presentations/hits/daily/days/"+("undefined"!=typeof e?e:30)+"/")}function l(){return d("service/presentations/hits/total/")}function d(e){return DP_AUTH.jso().ajax({url:DP_AUTH.config().api_endpoints.relay+e,datatype:"json"}).pipe(function(e){return!!e.status&&e.data}).fail(function(n,t,r){var o="<kbd>"+r+"</kbd>",i="<p>Forespørsel <code>"+e+"</code> feilet med melding: </p><p class='well'>"+JSON.parse(n.responseText).message+"</p><p><button class='btn btn-default icon ion-refresh' onclick='location.reload();'> Last siden på nytt?</button></p>";UTILS.alertError(o,i)})}var p,g,m,y,v,T,R=12e3,A=$.Deferred();return{ready:function(){return A},init:function(){e()},subscribersInfoXHR:function(){return p},subscribersInfo:function(){return g},serviceInfoXHR:function(){return m},serviceQueueXHR:function(){return t()},serviceQueueFailedJobsXHR:function(){return r()},serviceStorageXHR:function(){return y},usersTotalCountXHR:function(){return v},presentationsTotalXHR:function(){return T},hitsByDaysXHR:function(e){return f(e)},hitsTotalXHR:function(){return l()},orgCount:function(){return Object.keys(g).length},orgPresentationCount:function(e){return g[e]?g[e].presentations.total:0},orgEmployeesPresentationCount:function(e){return g[e]?g[e].presentations.employees:0},orgStudentsPresentationCount:function(e){return g[e]?g[e].presentations.students:0},orgPresentationListXHR:function(e){return u(e)},orgStorageTotalMiB:function(e){return g[e]?g[e].total_mib:0},orgStorageArr:function(e){return g[e]?g[e].storage:[]},orgUserCount:function(e){return g[e]?g[e].users.total:0},orgEmployeesCount:function(e){return g[e]?g[e].users.employees:0},orgStudentsCount:function(e){return g[e]?g[e].users.students:0},orgUserListXHR:function(e){return s(e)},storageCostTB:function(){return R},setStorageCost:function(e){return e=Number(e),isNaN(e)?(UTILS.alertError("Ugyldig verdi","Kostnaden du forsøker å legge inn er ikke et tall."),!1):(R=e,!0)},_getAPI:function(e){return d(e)}}}();